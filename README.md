# Масштабирование и сжатие картинок на PHP

## PHP resize_image()
Давно уже хотел написать функцию для изменения размеров картинок, чтобы совать ее на любой интернет-магазин. Однажды сел да и написал. Взял пример с программы ACDSee и FastStone Image Viewer - она пакетно работает с картинками.


## Это нужно Вам, если вы один из следующих людей:
- Вы хотя бы немного разбираетесь в PHP коде
- Вы делаете Интернет-магазины и не хотите загружать 10 разных размеров изображения
- Вы хотите, чтобы Google Pagespeed Insights пропускал Ваши изображения и давал сайту побольше баллов
- Вы делаете адаптивные сайты и понимаете, что картинку нельзя изменять с помощью max-width: 100%; из-за Retina дисплеев и скорости загрузки фото


## Как эта штука работает?
Очень просто - подключили файл, вызвали функцию, получили сохраненное изображение и путь до него. Путь к файлу преобразовали в относительную ссылку.


## Какие режимы работы скрипта?
1. **'oneside'** -- Изменить размер по одной из сторон
2. **'hard'** -- Жестко изменить размер изображения, не учитывая соотношение сторон
3. **'contain'** -- Поместить все изображение в заданные размеры с сохранением соотношения сторон
4. **'cover'** -- Заполнить заданные размеры изображением, даже если часть изображения не поместиться
5. **'fill'** -- Вместить изображение в указанные размеры, и дополнить белым цветом до указанных размеров 
> По правде говоря, режимы *contain*, *cover* и *oneside* всегда работают по одной стороне. Только в случае с *contain* магия производится по меньшей стороне, *cover* - по большей, а лишнее обрезается. *oneside* - по ширине, а если указана только высота - то по высоте.

## Пример кода
```
<?php
  require('resize_image.php'); // подключаем файл
  $dir = dirname(__FILE__); // запоминаем путь к папке, где лежит изображение
  $imgpath = $dir . '/1.jpg'; // указываем путь к изображению
  $path = resize_image($imgpath, 500, 150, 'contain'); // получаем изображение в папке "{$dir}/temp/img/xxx_xxx/image_{$hash}"
  $src = str_replace($dir . DIRECTORY_SEPARATOR, '', $path); // заменяем путь в файловой системе на относительную ссылку
?>
```


## Выводим
```
<img src="<?=$src;?>">
```


## Дополнительно
Если у вас подключено расширение PHP - Imagick, то из фотографий автоматически будут вырезаться Meta-данные
